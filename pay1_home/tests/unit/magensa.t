#!/bin/env perl
BEGIN {
  $ENV{'DEBUG'} = '';
}

use strict;
use Test::More qw( no_plan );
use magensa;

my $pgpDataStr = "LS0tLS1CRUdJTiBQR1AgTUVTU0FHRS0tLS0tCiAgCmhRSU1BNGVlckVneFdwQXZBUS85SGlDTUM4Nkc5TlpVb2JRTEpvOGlJeGRvejBqb1FjRFZhMGJEQnJaaGtHbUkKcUpTNXp1MUJrSE5CalIzOTVCMFUzQTNsOGNsVDVNL0d6M3NHSnYxUGxSZGFpbXk2bnczMFZveEJlTTJKelJaZQpYYjVlYkkxTmFLU1FQY1FUOHQyV3lUYjFBSXVyWGFXUVljemxFNytZZDZwcnZpdnpnYW9GY200d0owM3hpVWlDCjF2VExCMU1qUzVnZFcrajUva0hWVHJZTllzRXVNV3p2MXBPUE5Sa3ZhaWQweEVNN1d0eVJFYUJkaEZOTGtmazcKdVhHZ2c2eS9EbDYwSVBPUDZrSDVsZVphKzlwZitQZHRlSTVER3RoUUxFVXpoazdXay9yZktqbUFySlEvaXhUOQpFOHFubFNlcjdhL3VKZ2Q0TFlXTkxPUDFLQmNqbi9JZE5IQmVHVGVPSnZhc0FRUjB5VC9ORFFLbnZZUG9BNGN4CnlDZDZNNmpUekhvVjgzN2Jta3BxSTVvY3RBaDhIL3J5Rm0vTCtLN1Nlc29BaGx0eWNCTjJ1cTM5Zm1DMk8wQXUKa1I4RXUrNkIzNjFaYytWVFVsckw0WWtCbGh5clVUQlZqaGlEUEptNXlXVFJMd0kyOWZXR2d4emtIRW42bFA3NwpNTFZQcS9wa0ZTdWY0NjI2YUtWeDVONFRmZFhIS0VhalMrTUlVVjF4MmUxNG9PMlV1UFdpR0o1UlRxUGVFVDdsClRkeVBkUTB1dkN2SWpiYTBtQXY3aHljNEs0Wk9GelIzWk0ydStpeG9HUEpvNUZxZEF3OVBUeDNCd1Q3SkwvaXoKMlRtSTNYY2NsYlVVT2dsYjduWC9MTU9SUmpLdS8zWXNUQkRrSHc4a2tCM3R0RXBxVVE2YW9PK0I2dHdOOEo3UwpwZ0ZmVmoyU2ozVjVObkJoZU9ZSjUxZ205YThpM3VlWWNRSEpkMEh1cm5jMk16Y25vcTBsZFNIL3FqUHBnZzVECkZtbXUxRlVYOHE0RXk1SDlJSktoZWc2Rmc2U25oaTRPSGd3b3lBRURpQXFUa0hWYlNzbFk5Zk5ad0VhM01RdzcKQ2FycEt5OE9XY1BRcXo3MTZnWTRmZzlMWTMzZVdIUSthVUNPK3QrNGdJc01ieDdyQTBwSDU2L0YrTzZpNWFPLwpSUFJqVlFweXE4amJPKzhwTjhjenhtZHlveDg0UTVnPQo9cG1zbwotLS0tLUVORCBQR1AgTUVTU0FHRS0tLS0t";

my %res = &magensa::decryptPGP('pgpdata:' . $pgpDataStr, {});
ok($res{'StatusCode'} == '1000', 'magnesa::decryptPGP "StatusCode" == "1000"');
ok($res{'PAN'} == '4111111111111111', 'magnesa::decryptPGP "PAN" == "4111111111111111"');
